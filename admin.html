<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" />
  <title>ADMIN ADT - PRO</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --sidebar-bg: #0f172a;
      --accent: #6366f1;
      --bg: #f1f5f9;
      --card: #ffffff;
      --text: #0f172a;
      --border: #e2e8f0;
      --radius: 16px;
      --sidebar-width: 280px;
    }

    * { box-sizing: border-box; text-transform: uppercase; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
    body { margin: 0; display: flex; height: 100vh; background: var(--bg); overflow: hidden; }

    /* SIDEBAR */
    .sidebar { width: var(--sidebar-width); background: var(--sidebar-bg); color: white; display: flex; flex-direction: column; flex-shrink: 0; transition: transform 0.3s ease; z-index: 1001; }
    .sidebar-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: none; z-index: 1000; }
    
    .sidebar-brand { padding: 25px 20px; border-bottom: 1px solid #1e293b; text-align: center; }
    .sidebar-nav { padding: 10px; display: flex; flex-direction: column; gap: 5px; }
    .nav-btn { width: 100%; padding: 14px; background: transparent; border: none; color: #94a3b8; text-align: left; cursor: pointer; font-weight: 800; border-radius: 10px; font-size: 11px; }
    .nav-btn.active { background: #1e293b; color: white; border-left: 4px solid var(--accent); }

    .catalog-scroll { flex: 1; overflow-y: auto; padding: 10px; background: #0f172a; border-top: 1px solid #1e293b; }
    .cat-trigger { width: 100%; padding: 12px; background: #1e293b; border: none; color: white; text-align: left; font-size: 10px; font-weight: 800; display: flex; justify-content: space-between; border-radius: 8px; margin-bottom: 5px; }
    .cat-content { max-height: 0; overflow: hidden; transition: 0.3s; }
    .cat-accordion.active .cat-content { max-height: 1000px; padding: 10px 0; }
    .btn-quick { width: 100%; font-size: 9px; padding: 12px; background: #334155; border: none; color: white; border-radius: 6px; margin-top: 4px; font-weight: 800; }

    /* MAIN */
    .main-area { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
    .top-bar { padding: 12px 20px; background: white; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
    .btn-toggle { background: var(--sidebar-bg); color: white; border: none; width: 42px; height: 42px; border-radius: 10px; display: flex; align-items: center; justify-content: center; cursor: pointer; }

    .view-port { flex: 1; overflow-y: auto; padding: 20px; }
    .card { background: white; padding: 20px; border-radius: var(--radius); border: 1px solid var(--border); box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 20px; }

    /* FORMS */
    .grid-form { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
    input { width: 100%; padding: 14px; border: 1px solid var(--border); border-radius: 10px; font-weight: 800; font-size: 14px; background: #fcfcfc; }
    label { font-size: 10px; font-weight: 900; color: #64748b; margin-bottom: 6px; display: block; }
    
    .btn { padding: 14px 20px; border-radius: 10px; border: none; cursor: pointer; font-weight: 900; font-size: 11px; display: inline-flex; align-items: center; gap: 8px; }
    .btn-primary { background: var(--accent); color: white; width: 100%; justify-content: center; }
    .btn-danger { background: #fee2e2; color: #ef4444; }

    /* TABLES */
    .table-wrap { overflow-x: auto; -webkit-overflow-scrolling: touch; }
    table { width: 100%; border-collapse: collapse; min-width: 600px; }
    th { text-align: left; font-size: 10px; padding: 15px; background: #f8fafc; color: #64748b; }
    td { padding: 15px; border-bottom: 1px solid var(--bg); font-size: 12px; font-weight: 700; }

    /* LOGIN */
    #loginOverlay { position: fixed; inset: 0; background: var(--sidebar-bg); z-index: 2000; display: flex; align-items: center; justify-content: center; padding: 20px; }
    .login-card { background: white; padding: 40px; border-radius: 25px; width: 100%; max-width: 380px; }

    .hidden { display: none !important; }
    .draft-item { background: #f8fafc; border: 1px solid var(--border); padding: 15px; border-radius: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }

    @media (max-width: 900px) {
      .sidebar { position: fixed; height: 100vh; transform: translateX(-100%); }
      body.sidebar-open .sidebar { transform: translateX(0); }
      body.sidebar-open .sidebar-overlay { display: block; }
    }
  </style>
</head>
<body id="bodyTag">

  <div id="loginOverlay">
    <div class="login-card">
      <h2 style="text-align: center; margin: 0 0 30px;">ADT ADMIN</h2>
      <label>EMAIL</label><input id="lEmail" type="email">
      <label style="margin-top:15px;">PASSWORD</label><input id="lPass" type="password">
      <button class="btn btn-primary" style="margin-top: 25px;" onclick="handleLogin()">ENTRAR</button>
    </div>
  </div>

  <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

  <aside class="sidebar">
    <div class="sidebar-brand"><h2>MENU SYSTEM</h2></div>
    <div class="sidebar-nav">
      <button class="nav-btn active" id="navB" onclick="switchView('builder')">üõ† CONSTRUCTOR</button>
      <button class="nav-btn" id="navH" onclick="switchView('history')">üìú HISTORIAL</button>
      <button class="nav-btn hidden" id="navC" onclick="switchView('catalog')">üìÇ ALIMENTOS</button>
      <button class="nav-btn hidden" id="navU" onclick="switchView('users')">üë• USUARIOS</button>
    </div>
    <div id="pickerArea" class="catalog-scroll">
        <input type="text" id="catSearch" placeholder="üîç BUSCAR..." oninput="filterCat()" style="width:100%; background:#1e293b; border:none; color:white; padding:10px; border-radius:8px; margin-bottom:10px; font-size:10px;">
        <div id="catalogList"></div>
    </div>
  </aside>

  <main class="main-area hidden" id="appMain">
    <header class="top-bar">
      <div style="display: flex; align-items: center; gap: 12px;">
        <button class="btn-toggle" onclick="toggleSidebar()"><svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></button>
        <h1 id="viewTitle" style="font-size: 13px; margin: 0;">üõ† CONSTRUCTOR</h1>
      </div>
      <button class="btn" style="background:#e2e8f0; padding: 10px;" onclick="handleLogout()">SALIR</button>
    </header>

    <div class="view-port">
      <div class="container">
        
        <div id="viewBuilder">
          <div class="card">
            <div class="grid-form">
              <div><label>FECHA</label><input id="menuDate" type="date"></div>
              <div><label>NOMBRE AUTOM√ÅTICO</label><div id="autoName" style="font-size:16px; font-weight:900; color:var(--accent); margin-top:5px;">MEN√ö DEL D√çA</div></div>
            </div>
            <button class="btn btn-primary" style="margin-top: 20px; padding: 18px;" onclick="publishMenu()"
